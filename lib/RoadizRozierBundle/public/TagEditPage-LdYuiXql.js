import{t as a}from"./main-By1YoWKO.js";import"./jquery-Day_If3N.js";import"./vue-YhlLoeNc.js";class m extends HTMLElement{constructor(){super(),this.form=this.querySelector("#edit-tag-form"),this.formRow=this.querySelectorAll(".uk-form-row"),this.dropdown=null,this.onFormSubmit=this.onFormSubmit.bind(this)}connectedCallback(){this.form&&this.form.addEventListener("submit",this.onFormSubmit)}disconnectedCallback(){this.form&&this.form.removeEventListener("submit",this.onFormSubmit)}async onFormSubmit(e){e.preventDefault(),window.dispatchEvent(new CustomEvent("requestLoaderShow"));let r=new CustomEvent("pagechange");window.dispatchEvent(r);const t=new FormData(this.form),s=await fetch(window.location.href,{method:"POST",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:t});if(s.ok)this.cleanErrors();else{const o=await s.json();o.errors&&(this.displayErrors(o.errors),window.dispatchEvent(new CustomEvent("pushToast",{detail:{message:o.message,status:"danger"}})))}return await window.Rozier.refreshMainTagTree(),await window.Rozier.getMessages(),window.dispatchEvent(new CustomEvent("requestLoaderHide")),!1}cleanErrors(){document.querySelectorAll(".form-errored").forEach(r=>{r.classList.remove("form-errored"),r.querySelector(".error-message").remove()})}displayErrors(e,r){(!r||r===!1)&&this.cleanErrors();for(let t in e){let s=null,o=null;if(a(e[t])==="object")this.displayErrors(e[t],!0);else{s=t.replace("_","-"),e[t]instanceof Array?o=e[t][0]:o=e[t];let i=document.querySelector(".form-col-"+s);i&&(i.classList.add("form-errored"),i.insertAdjacentHTML("beforeend",'<p class="error-message uk-alert uk-alert-danger"><i class="uk-icon uk-icon-warning"></i> '+o+"</p>"))}}}}export{m as default};
